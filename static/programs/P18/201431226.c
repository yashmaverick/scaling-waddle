#include<stdio.h>
#include<stdlib.h>
int lev=0;
struct node{
	int c;
	struct node* next;
};
int count;
struct node* a[1001];
struct node* b[1001];
int d[1001];
int f[1001];
int visit[1001];
void frontdfs(struct node* x)
{
	if(lev==0)
{
	lev++;
}
else
{
	lev=0;
}
	struct node* aid;
	aid=x;
	if(lev==0)
{
	lev++;
}
else
{
	lev=0;
}
	while(aid!=NULL)
	{if(lev==0)
{
	lev++;
}
else
{
	lev=0;
}
		if(visit[aid->c]==0)
		{if(lev==0)
{
	lev++;
}
else
{
	lev=0;
}
			visit[aid->c]=1;
			frontdfs(b[aid->c]);
		}
		aid=aid->next;if(lev==0)
{
	lev++;
}
else
{
	lev=0;
}
	}
	return;
}
void backdfs(struct node* x)
{if(lev==0)
{
	lev++;
}
else
{
	lev=0;
}
	struct node* aid;
	aid=x;
	while(aid!=NULL)
	{if(lev==0)
{
	lev++;
}
else
{
	lev=0;
}
		if(visit[aid->c]==0)
		{if(lev==0)
{
	lev++;
}
else
{
	lev=0;
}
			count++;if(lev==0)
{
	lev++;
}
else
{
	lev=0;
}
			visit[aid->c]=1;
			backdfs(a[aid->c]);if(lev==0)
{
	lev++;
}
else
{
	lev=0;
}
		}
		aid=aid->next;if(lev==0)
{
	lev++;
}
else
{
	lev=0;
}
	}
	return;
}
int main()
{if(lev==0)
{
	lev++;
}
else
{
	lev=0;
}
	struct node* temp;if(lev==0)
{
	lev++;
}
else
{
	lev=0;
}
	struct node* ans;if(lev==0)
{
	lev++;
}
else
{
	lev=0;
}
	struct node* help;if(lev==0)
{
	lev++;
}
else
{
	lev=0;
}
	struct node* var;
	struct node* fun;if(lev==0)
{
	lev++;
}
else
{
	lev=0;
}
	int m,n,l,p,o,u,v,k,t,r,y,z;if(lev==0)
{
	lev++;
}
else
{
	lev=0;
}
	scanf("%d",&t);
	for(k=0;k<t;k++)
	{if(lev==0)
{
	lev++;
}
else
{
	lev=0;
}
		for(v=0;v<1001;v++)
		{if(lev==0)
{
	lev++;
}
else
{
	lev=0;
}
			d[v]=0;
			b[v]=NULL;if(lev==0)
{
	lev++;
}
else
{
	lev=0;
}
		}
		for(v=0;v<1001;v++)
		{if(lev==0)
{
	lev++;
}
else
{
	lev=0;
}
			f[v]=0;
			a[v]=NULL;
		}
		scanf("%d",&r);if(lev==0)
{
	lev++;
}
else
{
	lev=0;
}
		for(m=1;m<=r;m++)
		{if(lev==0)
{
	lev++;
}
else
{
	lev=0;
}
			scanf("%d",&n);
			for(l=0;l<n;l++)
			{if(lev==0)
{
	lev++;
}
else
{
	lev=0;
}if(lev==0)
{
	lev++;
}
else
{
	lev=0;
}
				scanf("%d",&p);
				temp=malloc(sizeof(struct node));if(lev==0)
{
	lev++;
}
else
{
	lev=0;
}
				temp->c=p;
				temp->next=NULL;
				if(d[m]==0)
				{if(lev==0)
{
	lev++;
}
else
{
	lev=0;
}
					a[m]=temp;
					d[m]=1;if(lev==0)
{
	lev++;
}
else
{
	lev=0;
}
				}
				else
				{if(lev==0)
{
	lev++;
}
else
{
	lev=0;
}
					temp->next=a[m];
					a[m]=temp;if(lev==0)
{
	lev++;
}
else
{
	lev=0;
}
				}
				var=malloc(sizeof(struct node));if(lev==0)
{
	lev++;
}
else
{
	lev=0;
}
				var->c=m;
				var->next=NULL;
				if(f[p]==0)
				{if(lev==0)
{
	lev++;
}
else
{
	lev=0;
}
					b[p]=var;
					f[p]=1;
				}
				else
				{if(lev==0)
{
	lev++;
}
else
{
	lev=0;
}
					var->next=b[p];
					b[p]=var;
				}
			}if(lev==0)
{
	lev++;
}
else
{
	lev=0;
}
		}//m realms
		for(u=1;u<=r;u++)
		{if(lev==0)
{
	lev++;
}
else
{
	lev=0;
}
			for(o=0;o<1001;o++)
			{if(lev==0)
{
	lev++;
}
else
{
	lev=0;
}
				visit[o]=0;
			}if(lev==0)
{
	lev++;
}
else
{
	lev=0;
}
			visit[u]=1;
			frontdfs(b[u]);
			for(o=1;o<=r;o++)
			{if(lev==0)
{
	lev++;
}
else
{
	lev=0;
}
				if(visit[o]==1)
					continue;
				else
					break;
			}
			if(o==(r+1))
			{if(lev==0)
{
	lev++;
}
else
{
	lev=0;
}

				ans=a[u];
				break;
			}
		}if(lev==0)
{
	lev++;
}
else
{
	lev=0;
}
		if(u==r+1)
		{if(lev==0)
{
	lev++;
}
else
{
	lev=0;
}
			printf("0\n");
			continue;
		}
		for(o=0;o<1001;o++)
		{if(lev==0)
{
	lev++;
}
else
{
	lev=0;
}
			visit[o]=0;
		}
		visit[u]=1;
		count=0;if(lev==0)
{
	lev++;
}
else
{
	lev=0;
}
		backdfs(ans);if(lev==0)
{
	lev++;
}
else
{
	lev=0;
}
		printf("%d\n",count+1);if(lev==0)
{
	lev++;
}
else
{
	lev=0;
}
	}//testcases
	return 0;
}//main

