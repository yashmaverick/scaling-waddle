#include<stdio.h>
long long int sz=0;
int main()
{
	long long int i,j,b[500005],n,x,l,p,ans,r=0;
	long long int a[500005];
	while(1)
	{
		sz=ans=0;
		scanf("%lld",&n);
		if(n==0)
			break;
		for(i=0;i<n;i++)
			scanf("%lld",&a[i]);
		i=0;
		while(i<n)
		{
			if(sz==0||b[sz-1]>=a[i])
			{
				b[sz]=a[i];
				sz++;
			}
			else
			{
				while(sz!=0&&b[sz-1]<a[i])
				{
				p=b[sz-1];
				j=sz-2;
				l=1;
				while(p==b[j])
				{
					j--;
					l++;
				}
				if(j>0)
					ans=ans+(j*l);
				ans=ans+((n-i-1)*l);
				sz=j+1;
				}
				b[sz]=a[i];
				sz++;
			}
			i++;
		}
		while(sz>1)
		{
				p=b[sz-1];
				j=sz-2;
				l=1;
				while(p==b[j])
				{
					j--;
					l++;
				}
				if(j>0)
					ans=ans+(j*l);
				sz=j+1;
		}
		printf("%lld\n",ans);
	}
	return 0;
}
