<table><tr style="vertical-align:top;"><td style="min-width:40px; text-align: right;"><pre style="
        font-size: 11px;
        font-family: Bitstream Vera Sans Mono,monospace;
        background-color: transparent;
        margin: 0;
        padding: 5px;
        border: none;
        color: #A0A0A0;
">1.<br/>2.<br/>3.<br/>4.<br/>5.<br/>6.<br/>7.<br/>8.<br/>9.<br/>10.<br/>11.<br/>12.<br/>13.<br/>14.<br/>15.<br/>16.<br/>17.<br/>18.<br/>19.<br/>20.<br/>21.<br/>22.<br/>23.<br/>24.<br/>25.<br/>26.<br/>27.<br/>28.<br/>29.<br/>30.<br/>31.<br/>32.<br/>33.<br/>34.<br/>35.<br/>36.<br/>37.<br/>38.<br/>39.<br/>40.<br/>41.<br/>42.<br/>43.<br/>44.<br/>45.<br/>46.<br/>47.<br/>48.<br/>49.<br/>50.<br/>51.<br/>52.<br/>53.<br/>54.<br/>55.<br/>56.<br/>57.<br/>58.<br/>59.<br/>60.<br/>61.<br/>62.<br/>63.<br/>64.<br/>65.<br/>66.<br/>67.<br/>68.<br/>69.<br/>70.<br/>71.<br/>72.<br/>73.<br/>74.<br/>75.<br/>76.<br/>77.<br/>78.<br/>79.<br/>80.<br/>81.<br/>82.<br/>83.<br/>84.<br/>85.<br/>86.<br/>87.<br/>88.<br/>89.<br/>90.<br/>91.<br/>92.<br/>93.<br/>94.<br/>95.<br/>96.<br/>97.<br/>98.<br/>99.<br/>100.<br/>101.<br/>102.<br/>103.<br/>104.<br/>105.<br/>106.<br/>107.<br/>108.<br/>109.<br/>110.<br/>111.<br/>112.<br/>113.<br/>114.<br/>115.<br/>116.<br/>117.<br/>118.<br/>119.<br/>120.<br/>121.<br/>122.<br/>123.<br/>124.<br/>125.<br/>126.<br/>127.<br/>128.<br/>129.<br/>130.<br/>131.<br/>132.<br/>133.<br/>134.<br/>135.<br/>136.<br/>137.<br/>138.<br/>139.</pre></td><td><pre style="
        font-size: 11px;
        font-family: Bitstream Vera Sans Mono,monospace;
        background-color: transparent;
        margin: 0;
        padding: 5px;
        border: none;
        overflow: auto;
        white-space: pre !important;
"><span style="color: green; font-style: italic">#include&lt;stdio.h&gt;<br/>#include&lt;stdlib.h&gt;<br/>#include&lt;string.h&gt;<br/>#include&lt;limits.h&gt;<br/><br/>#define gu getchar_unlocked <br/>#define pu putchar_unlocked<br/>#define LL long long int<br/>#define ULL unsigned long long int<br/>#define si(n) scanf("%d",&amp;n)<br/>#define dout(n) printf("%d\n",n)<br/>#define sll(n) scanf("%lld",&amp;n)<br/>#define lldout(n) printf("%lld\n",n)<br/><br/>#define min(a,b) ((a)&lt;(b)?(a):(b))<br/>#define max(a,b) ((a)&lt;(b)?(b):(a))<br/>#define ROUNDOFFINT(d) d = (int)((double)d + 0.5)<br/>#define PLUSWRAP(index,n) index = (index+1)%n<br/>#define MINUSWRAP(index,n) index = (index + n -1)%n<br/><br/>#define INF 1000000000  //1 billion (10^9)<br/><br/>#define FLUSHN while(gu()!='\n')<br/>#define FLUSHS while(gu()!=' ')<br/><br/><br/><br/></span>typedef struct node<span style="font-weight: bold">{<br/></span> int val;<br/>    struct node<span style="font-weight: bold">* </span>next;<br/><span style="font-weight: bold">}</span>node;<br/><br/>void insert<span style="font-weight: bold">(</span>node<span style="font-weight: bold">** </span>head<span style="font-weight: bold">,</span>int elem<span style="font-weight: bold">)<br/>{<br/></span> node<span style="font-weight: bold">* </span>p <span style="font-weight: bold">= (</span>node<span style="font-weight: bold">*)</span>malloc<span style="font-weight: bold">(</span>sizeof<span style="font-weight: bold">(</span>node<span style="font-weight: bold">))</span>;<br/>    p<span style="font-weight: bold">-&gt;</span>val <span style="font-weight: bold">= </span>elem;<br/>    p<span style="font-weight: bold">-&gt;</span>next <span style="font-weight: bold">= *</span>head;<br/>    <span style="font-weight: bold">*</span>head <span style="font-weight: bold">= </span>p;<br/>    <span style="color:#185369; font-weight: bold">return</span>;<br/><span style="font-weight: bold">}<br/><br/></span><span style="color: green; font-style: italic">#define N 15000<br/><br/></span>int <span style="text-decoration:None;color:#FF5C1F;">P</span><span style="font-weight: bold">[</span>N<span style="font-weight: bold">]</span>;<br/>int <span style="text-decoration:None;color:#FF5C1F;">A</span><span style="font-weight: bold">[</span>N<span style="font-weight: bold">]</span>;<br/>int pos<span style="font-weight: bold">[</span>N<span style="font-weight: bold">]</span>;<br/>node<span style="font-weight: bold">* </span>graph<span style="font-weight: bold">[</span>N<span style="font-weight: bold">]</span>;<br/>int ans<span style="font-weight: bold">[</span><span style="color: red">2000</span><span style="font-weight: bold">][</span><span style="color: red">2000</span><span style="font-weight: bold">]</span>;<br/>int visited<span style="font-weight: bold">[</span>N<span style="font-weight: bold">]</span>;<br/>int len;<br/>int diff<span style="font-weight: bold">(</span>int a<span style="font-weight: bold">,</span>int b<span style="font-weight: bold">)<br/>{<br/></span> int ndiff <span style="font-weight: bold">= </span><span style="color: red">0</span>;<br/>    <span style="color:#185369; font-weight: bold">while</span><span style="font-weight: bold">(</span>a<span style="font-weight: bold">)<br/></span> <span style="font-weight: bold">{<br/></span>     <span style="color:#185369; font-weight: bold">if</span><span style="font-weight: bold">(</span>a<span style="font-weight: bold">%</span><span style="color: red">10 </span><span style="font-weight: bold">!= </span>b<span style="font-weight: bold">%</span><span style="color: red">10</span><span style="font-weight: bold">) </span>ndiff<span style="font-weight: bold">++</span>;<br/>        a <span style="font-weight: bold">= </span>a<span style="font-weight: bold">/</span><span style="color: red">10</span>;<br/>        b <span style="font-weight: bold">= </span>b<span style="font-weight: bold">/</span><span style="color: red">10</span>;<br/>    <span style="font-weight: bold">}<br/></span> <span style="color:#185369; font-weight: bold">if</span><span style="font-weight: bold">(</span>ndiff <span style="font-weight: bold">== </span><span style="color: red">1</span><span style="font-weight: bold">)<br/></span>     <span style="color:#185369; font-weight: bold">return </span><span style="color: red">1</span>;<br/>    <span style="color:#185369; font-weight: bold">return </span><span style="color: red">0</span>;<br/><span style="font-weight: bold">}<br/></span>int queue<span style="font-weight: bold">[</span>N<span style="font-weight: bold">]</span>;<br/>int front<span style="font-weight: bold">,</span>end;<br/>int dist<span style="font-weight: bold">[</span>N<span style="font-weight: bold">]</span>;<br/><br/>void bfs<span style="font-weight: bold">(</span>int a<span style="font-weight: bold">)<br/>{<br/></span> front <span style="font-weight: bold">= </span>end<span style="font-weight: bold">=</span><span style="color: red">0</span>;<br/>    queue<span style="font-weight: bold">[</span>end<span style="font-weight: bold">++] = </span>a;<br/>    node<span style="font-weight: bold">* </span>it;<br/>    int i;<br/>    <span style="color:#185369; font-weight: bold">for</span><span style="font-weight: bold">(</span>i<span style="font-weight: bold">=</span><span style="color: red">1000</span>;i<span style="font-weight: bold">&lt;=</span><span style="color: red">9999</span>;i<span style="font-weight: bold">++)<br/></span> <span style="font-weight: bold">{<br/></span>     visited<span style="font-weight: bold">[</span>i<span style="font-weight: bold">]=</span><span style="color: red">0</span>;<br/>        dist<span style="font-weight: bold">[</span>i<span style="font-weight: bold">]=-</span><span style="color: red">1</span>;<br/>    <span style="font-weight: bold">}<br/></span> dist<span style="font-weight: bold">[</span>a<span style="font-weight: bold">]=</span><span style="color: red">0</span>;<br/>    <span style="color:#185369; font-weight: bold">while</span><span style="font-weight: bold">(</span>front<span style="font-weight: bold">&lt;</span>end<span style="font-weight: bold">)<br/></span> <span style="font-weight: bold">{<br/></span>     int u <span style="font-weight: bold">= </span>queue<span style="font-weight: bold">[</span>front<span style="font-weight: bold">]</span>;<br/>        front<span style="font-weight: bold">++</span>;<br/>        visited<span style="font-weight: bold">[</span>u<span style="font-weight: bold">]=</span><span style="color: red">1</span>;<br/>        <span style="color:#185369; font-weight: bold">for</span><span style="font-weight: bold">(</span>it <span style="font-weight: bold">= </span>graph<span style="font-weight: bold">[</span>u<span style="font-weight: bold">]</span>;it<span style="font-weight: bold">!=</span>NULL;it <span style="font-weight: bold">= </span>it<span style="font-weight: bold">-&gt;</span>next<span style="font-weight: bold">)<br/></span>     <span style="font-weight: bold">{<br/></span>         <span style="color:#185369; font-weight: bold">if</span><span style="font-weight: bold">(!</span>visited<span style="font-weight: bold">[</span>it<span style="font-weight: bold">-&gt;</span>val<span style="font-weight: bold">])<br/></span>         <span style="font-weight: bold">{<br/></span>             visited<span style="font-weight: bold">[</span>it<span style="font-weight: bold">-&gt;</span>val<span style="font-weight: bold">] = </span><span style="color: red">1</span>;<br/>                queue<span style="font-weight: bold">[</span>end<span style="font-weight: bold">++] = </span>it<span style="font-weight: bold">-&gt;</span>val;<br/>                dist<span style="font-weight: bold">[</span>it<span style="font-weight: bold">-&gt;</span>val<span style="font-weight: bold">] = </span>dist<span style="font-weight: bold">[</span>u<span style="font-weight: bold">] + </span><span style="color: red">1</span>;<br/>            <span style="font-weight: bold">}<br/></span>     <span style="font-weight: bold">}<br/></span> <span style="font-weight: bold">}<br/></span> <span style="color:#185369; font-weight: bold">for</span><span style="font-weight: bold">(</span>i<span style="font-weight: bold">=</span><span style="color: red">0</span>;i<span style="font-weight: bold">&lt;</span>len;i<span style="font-weight: bold">++)<br/></span>     ans<span style="font-weight: bold">[</span>pos<span style="font-weight: bold">[</span>a<span style="font-weight: bold">]][</span>i<span style="font-weight: bold">]=</span>dist<span style="font-weight: bold">[</span><span style="text-decoration:None;color:#FF5C1F;">A</span><span style="font-weight: bold">[</span>i<span style="font-weight: bold">]]</span>;<br/><span style="font-weight: bold">}<br/><br/></span>int main<span style="font-weight: bold">()<br/>{<br/></span> int i<span style="font-weight: bold">,</span>j;<br/>    <span style="text-decoration:None;color:#FF5C1F;">P</span><span style="font-weight: bold">[</span><span style="color: red">0</span><span style="font-weight: bold">]=</span><span style="text-decoration:None;color:#FF5C1F;">P</span><span style="font-weight: bold">[</span><span style="color: red">1</span><span style="font-weight: bold">]=</span><span style="color: red">1</span>;<br/>    <span style="color:#185369; font-weight: bold">for</span><span style="font-weight: bold">(</span>i<span style="font-weight: bold">=</span><span style="color: red">2</span>;i<span style="font-weight: bold">*</span>i<span style="font-weight: bold">&lt;</span>N;i<span style="font-weight: bold">++)<br/></span>     <span style="color:#185369; font-weight: bold">if</span><span style="font-weight: bold">(!</span><span style="text-decoration:None;color:#FF5C1F;">P</span><span style="font-weight: bold">[</span>i<span style="font-weight: bold">])<br/></span>         <span style="color:#185369; font-weight: bold">for</span><span style="font-weight: bold">(</span>j<span style="font-weight: bold">=</span>i<span style="font-weight: bold">*</span>i;j<span style="font-weight: bold">&lt;</span>N;j<span style="font-weight: bold">+=</span>i<span style="font-weight: bold">)<br/></span>             <span style="text-decoration:None;color:#FF5C1F;">P</span><span style="font-weight: bold">[</span>j<span style="font-weight: bold">]=</span><span style="color: red">1</span>;<br/>    <span style="color:#185369; font-weight: bold">for</span><span style="font-weight: bold">(</span>i<span style="font-weight: bold">=</span><span style="color: red">1000</span>;i<span style="font-weight: bold">&lt;</span><span style="color: red">10000</span>;i<span style="font-weight: bold">++)<br/></span>     <span style="color:#185369; font-weight: bold">if</span><span style="font-weight: bold">(!</span><span style="text-decoration:None;color:#FF5C1F;">P</span><span style="font-weight: bold">[</span>i<span style="font-weight: bold">])<br/></span>     <span style="font-weight: bold">{<br/></span>         pos<span style="font-weight: bold">[</span>i<span style="font-weight: bold">] = </span>len;<br/>            <span style="text-decoration:None;color:#FF5C1F;">A</span><span style="font-weight: bold">[</span>len<span style="font-weight: bold">++] = </span>i;<br/>        <span style="font-weight: bold">}<br/><br/></span> <span style="color:#185369; font-weight: bold">for</span><span style="font-weight: bold">(</span>i<span style="font-weight: bold">=</span><span style="color: red">0</span>;i<span style="font-weight: bold">&lt;</span>len;i<span style="font-weight: bold">++)<br/></span>     <span style="color:#185369; font-weight: bold">for</span><span style="font-weight: bold">(</span>j<span style="font-weight: bold">=</span>i<span style="font-weight: bold">+</span><span style="color: red">1</span>;j<span style="font-weight: bold">&lt;</span>len;j<span style="font-weight: bold">++)<br/></span>         <span style="color:#185369; font-weight: bold">if</span><span style="font-weight: bold">(</span>diff<span style="font-weight: bold">(</span><span style="text-decoration:None;color:#FF5C1F;">A</span><span style="font-weight: bold">[</span>i<span style="font-weight: bold">],</span><span style="text-decoration:None;color:#FF5C1F;">A</span><span style="font-weight: bold">[</span>j<span style="font-weight: bold">]))<br/></span>             insert<span style="font-weight: bold">(&amp;</span>graph<span style="font-weight: bold">[</span><span style="text-decoration:None;color:#FF5C1F;">A</span><span style="font-weight: bold">[</span>i<span style="font-weight: bold">]],</span><span style="text-decoration:None;color:#FF5C1F;">A</span><span style="font-weight: bold">[</span>j<span style="font-weight: bold">]),</span>insert<span style="font-weight: bold">(&amp;</span>graph<span style="font-weight: bold">[</span><span style="text-decoration:None;color:#FF5C1F;">A</span><span style="font-weight: bold">[</span>j<span style="font-weight: bold">]],</span><span style="text-decoration:None;color:#FF5C1F;">A</span><span style="font-weight: bold">[</span>i<span style="font-weight: bold">])</span>;<br/>    <span style="color:#185369; font-weight: bold">for</span><span style="font-weight: bold">(</span>i<span style="font-weight: bold">=</span><span style="color: red">0</span>;i<span style="font-weight: bold">&lt;</span>len;i<span style="font-weight: bold">++)<br/></span>     bfs<span style="font-weight: bold">(</span><span style="text-decoration:None;color:#FF5C1F;">A</span><span style="font-weight: bold">[</span>i<span style="font-weight: bold">])</span>;<br/>    int t;si<span style="font-weight: bold">(</span>t<span style="font-weight: bold">)</span>;<br/>    <span style="color:#185369; font-weight: bold">while</span><span style="font-weight: bold">(</span>t<span style="font-weight: bold">--)<br/></span> <span style="font-weight: bold">{<br/></span>     int a<span style="font-weight: bold">,</span>b;<br/>        si<span style="font-weight: bold">(</span>a<span style="font-weight: bold">)</span>;si<span style="font-weight: bold">(</span>b<span style="font-weight: bold">)</span>;<br/>        <span style="color:#185369; font-weight: bold">if</span><span style="font-weight: bold">(</span>a<span style="font-weight: bold">&gt;</span>b<span style="font-weight: bold">)<br/></span>     <span style="font-weight: bold">{<br/></span>         int temp <span style="font-weight: bold">= </span>b;<br/>            b <span style="font-weight: bold">= </span>a;<br/>            a <span style="font-weight: bold">= </span>temp;<br/>        <span style="font-weight: bold">}<br/></span>     <span style="color:#185369; font-weight: bold">if</span><span style="font-weight: bold">(</span>ans<span style="font-weight: bold">[</span>pos<span style="font-weight: bold">[</span>a<span style="font-weight: bold">]][</span>pos<span style="font-weight: bold">[</span>b<span style="font-weight: bold">]] == -</span><span style="color: red">1</span><span style="font-weight: bold">)<br/></span>         printf<span style="font-weight: bold">(</span><span style="color: #FF9966">"Impossible\n"</span><span style="font-weight: bold">)</span>;<br/>        <span style="color:#185369; font-weight: bold">else<br/></span>         dout<span style="font-weight: bold">(</span>ans<span style="font-weight: bold">[</span>pos<span style="font-weight: bold">[</span>a<span style="font-weight: bold">]][</span>pos<span style="font-weight: bold">[</span>b<span style="font-weight: bold">]])</span>;<br/><br/>    <span style="font-weight: bold">}<br/></span> <span style="color:#185369; font-weight: bold">return </span><span style="color: red">0</span>;<br/><span style="font-weight: bold">}<br/></span></pre></td></tr></table>