<table><tr style="vertical-align:top;"><td style="min-width:40px; text-align: right;"><pre style="
        font-size: 11px;
        font-family: Bitstream Vera Sans Mono,monospace;
        background-color: transparent;
        margin: 0;
        padding: 5px;
        border: none;
        color: #A0A0A0;
">1.<br/>2.<br/>3.<br/>4.<br/>5.<br/>6.<br/>7.<br/>8.<br/>9.<br/>10.<br/>11.<br/>12.<br/>13.<br/>14.<br/>15.<br/>16.<br/>17.<br/>18.<br/>19.<br/>20.<br/>21.<br/>22.<br/>23.<br/>24.<br/>25.<br/>26.<br/>27.<br/>28.<br/>29.<br/>30.<br/>31.<br/>32.<br/>33.<br/>34.<br/>35.<br/>36.<br/>37.<br/>38.<br/>39.<br/>40.<br/>41.<br/>42.<br/>43.<br/>44.<br/>45.<br/>46.<br/>47.<br/>48.<br/>49.<br/>50.<br/>51.<br/>52.<br/>53.<br/>54.<br/>55.<br/>56.<br/>57.<br/>58.<br/>59.<br/>60.<br/>61.<br/>62.<br/>63.<br/>64.<br/>65.<br/>66.<br/>67.<br/>68.<br/>69.<br/>70.<br/>71.<br/>72.<br/>73.<br/>74.<br/>75.<br/>76.<br/>77.<br/>78.<br/>79.<br/>80.<br/>81.<br/>82.<br/>83.<br/>84.<br/>85.<br/>86.<br/>87.<br/>88.<br/>89.<br/>90.<br/>91.</pre></td><td><pre style="
        font-size: 11px;
        font-family: Bitstream Vera Sans Mono,monospace;
        background-color: transparent;
        margin: 0;
        padding: 5px;
        border: none;
        overflow: auto;
        white-space: pre !important;
"><span style="font-weight: bold">//</span>Abhishek Bansal<br/><span style="color: green; font-style: italic">#define si(n) scanf("%d",&amp;n)<br/>#define sll(n) scanf("%lld",&amp;n)<br/>#define sout(n) printf("%d\n",n)<br/>#define loop(a,b) for(i=a;i&lt;b;i++)<br/>#define max(a,b) ((a)&gt;(b)?(a):(b))<br/>#define min(a,b) ((a)&lt;(b)?(a):(b))<br/>#define SET(a,b) memset(a,b,sizeof(a))<br/>#include&lt;stdio.h&gt;<br/>#include&lt;stdlib.h&gt;<br/>#include&lt;string.h&gt;<br/></span>typedef long long int lli;<br/>int prime<span style="font-weight: bold">[</span><span style="color: red">10000</span><span style="font-weight: bold">]</span>;<br/>int dist<span style="font-weight: bold">[</span><span style="color: red">10000</span><span style="font-weight: bold">]</span>;<br/>typedef struct node<span style="font-weight: bold">{<br/></span> int val;<br/>    struct node<span style="font-weight: bold">* </span>next;<br/><span style="font-weight: bold">}</span>node;<br/>node<span style="font-weight: bold">* </span>graph<span style="font-weight: bold">[</span><span style="color: red">10000</span><span style="font-weight: bold">]</span>;<br/>node<span style="font-weight: bold">* </span>insert<span style="font-weight: bold">(</span>node<span style="font-weight: bold">* </span>head<span style="font-weight: bold">,</span>int x<span style="font-weight: bold">){<br/></span> node<span style="font-weight: bold">* </span>n<span style="font-weight: bold">=(</span>node<span style="font-weight: bold">*)</span>malloc<span style="font-weight: bold">(</span>sizeof<span style="font-weight: bold">(</span>node<span style="font-weight: bold">))</span>;<br/>    n<span style="font-weight: bold">-&gt;</span>val<span style="font-weight: bold">=</span>x;<br/>    n<span style="font-weight: bold">-&gt;</span>next<span style="font-weight: bold">=</span>head;<br/>    <span style="color:#185369; font-weight: bold">return </span>n;<br/><span style="font-weight: bold">}<br/></span>int check<span style="font-weight: bold">(</span>int a<span style="font-weight: bold">,</span>int b<span style="font-weight: bold">){<br/></span> int a1<span style="font-weight: bold">,</span>a2<span style="font-weight: bold">,</span>a3<span style="font-weight: bold">,</span>a4<span style="font-weight: bold">,</span>b1<span style="font-weight: bold">,</span>b2<span style="font-weight: bold">,</span>b3<span style="font-weight: bold">,</span>b4;<br/>    a1<span style="font-weight: bold">=</span>a<span style="font-weight: bold">/</span><span style="color: red">1000</span>;a2<span style="font-weight: bold">=(</span>a<span style="font-weight: bold">%</span><span style="color: red">1000</span><span style="font-weight: bold">)/</span><span style="color: red">100</span>;a3<span style="font-weight: bold">=(</span>a<span style="font-weight: bold">%</span><span style="color: red">100</span><span style="font-weight: bold">)/</span><span style="color: red">10</span><span style="font-weight: bold">,</span>a4<span style="font-weight: bold">=</span>a<span style="font-weight: bold">%</span><span style="color: red">10</span>;<br/>    b1<span style="font-weight: bold">=</span>b<span style="font-weight: bold">/</span><span style="color: red">1000</span>;b2<span style="font-weight: bold">=(</span>b<span style="font-weight: bold">%</span><span style="color: red">1000</span><span style="font-weight: bold">)/</span><span style="color: red">100</span>;b3<span style="font-weight: bold">=(</span>b<span style="font-weight: bold">%</span><span style="color: red">100</span><span style="font-weight: bold">)/</span><span style="color: red">10</span><span style="font-weight: bold">,</span>b4<span style="font-weight: bold">=</span>b<span style="font-weight: bold">%</span><span style="color: red">10</span>;<br/>    <span style="color:#185369; font-weight: bold">if</span><span style="font-weight: bold">(</span>a1<span style="font-weight: bold">!=</span>b1<span style="font-weight: bold">&amp;&amp;</span>a2<span style="font-weight: bold">==</span>b2<span style="font-weight: bold">&amp;&amp;</span>a3<span style="font-weight: bold">==</span>b3<span style="font-weight: bold">&amp;&amp;</span>a4<span style="font-weight: bold">==</span>b4<span style="font-weight: bold">)</span><span style="color:#185369; font-weight: bold">return </span><span style="color: red">1</span>;<br/>    <span style="color:#185369; font-weight: bold">else if</span><span style="font-weight: bold">(</span>a1<span style="font-weight: bold">==</span>b1<span style="font-weight: bold">&amp;&amp;</span>a2<span style="font-weight: bold">!=</span>b2<span style="font-weight: bold">&amp;&amp;</span>a3<span style="font-weight: bold">==</span>b3<span style="font-weight: bold">&amp;&amp;</span>a4<span style="font-weight: bold">==</span>b4<span style="font-weight: bold">)</span><span style="color:#185369; font-weight: bold">return </span><span style="color: red">1</span>;<br/>    <span style="color:#185369; font-weight: bold">else if</span><span style="font-weight: bold">(</span>a1<span style="font-weight: bold">==</span>b1<span style="font-weight: bold">&amp;&amp;</span>a2<span style="font-weight: bold">==</span>b2<span style="font-weight: bold">&amp;&amp;</span>a3<span style="font-weight: bold">!=</span>b3<span style="font-weight: bold">&amp;&amp;</span>a4<span style="font-weight: bold">==</span>b4<span style="font-weight: bold">)</span><span style="color:#185369; font-weight: bold">return </span><span style="color: red">1</span>;<br/>    <span style="color:#185369; font-weight: bold">else if</span><span style="font-weight: bold">(</span>a1<span style="font-weight: bold">==</span>b1<span style="font-weight: bold">&amp;&amp;</span>a2<span style="font-weight: bold">==</span>b2<span style="font-weight: bold">&amp;&amp;</span>a3<span style="font-weight: bold">==</span>b3<span style="font-weight: bold">&amp;&amp;</span>a4<span style="font-weight: bold">!=</span>b4<span style="font-weight: bold">)</span><span style="color:#185369; font-weight: bold">return </span><span style="color: red">1</span>;<br/>    <span style="color:#185369; font-weight: bold">else return </span><span style="color: red">0</span>;<br/><span style="font-weight: bold">}<br/></span>int bfs<span style="font-weight: bold">(</span>int s<span style="font-weight: bold">,</span>int d<span style="font-weight: bold">){<br/></span> SET<span style="font-weight: bold">(</span>dist<span style="font-weight: bold">,-</span><span style="color: red">1</span><span style="font-weight: bold">)</span>;<br/>    dist<span style="font-weight: bold">[</span>s<span style="font-weight: bold">]=</span><span style="color: red">0</span>;<br/>    int q<span style="font-weight: bold">[</span><span style="color: red">10000</span><span style="font-weight: bold">],</span>tail<span style="font-weight: bold">=-</span><span style="color: red">1</span><span style="font-weight: bold">,</span>head<span style="font-weight: bold">=</span><span style="color: red">0</span>;<br/>    q<span style="font-weight: bold">[++</span>tail<span style="font-weight: bold">]=</span>s;<br/>    <span style="color:#185369; font-weight: bold">while</span><span style="font-weight: bold">(</span>q<span style="font-weight: bold">[</span>head<span style="font-weight: bold">]!=</span>d<span style="font-weight: bold">){<br/></span>     int t<span style="font-weight: bold">=</span>q<span style="font-weight: bold">[</span>head<span style="font-weight: bold">++]</span>;<br/>        node<span style="font-weight: bold">* </span>tmp<span style="font-weight: bold">=</span>graph<span style="font-weight: bold">[</span>t<span style="font-weight: bold">]</span>;<br/>        <span style="color:#185369; font-weight: bold">while</span><span style="font-weight: bold">(</span>tmp<span style="font-weight: bold">){<br/></span>         <span style="color:#185369; font-weight: bold">if</span><span style="font-weight: bold">(</span>dist<span style="font-weight: bold">[</span>tmp<span style="font-weight: bold">-&gt;</span>val<span style="font-weight: bold">]==-</span><span style="color: red">1</span><span style="font-weight: bold">){<br/></span>             q<span style="font-weight: bold">[++</span>tail<span style="font-weight: bold">]=</span>tmp<span style="font-weight: bold">-&gt;</span>val;<br/>                dist<span style="font-weight: bold">[</span>tmp<span style="font-weight: bold">-&gt;</span>val<span style="font-weight: bold">]=</span>dist<span style="font-weight: bold">[</span>t<span style="font-weight: bold">]+</span><span style="color: red">1</span>;<br/>            <span style="font-weight: bold">}<br/></span>         tmp<span style="font-weight: bold">=</span>tmp<span style="font-weight: bold">-&gt;</span>next;<br/>        <span style="font-weight: bold">}<br/></span> <span style="font-weight: bold">}<br/></span> <span style="color:#185369; font-weight: bold">return </span>dist<span style="font-weight: bold">[</span>d<span style="font-weight: bold">]</span>;<br/><span style="font-weight: bold">}<br/></span>int main<span style="font-weight: bold">(){<br/></span> int i<span style="font-weight: bold">,</span>j<span style="font-weight: bold">,</span>c<span style="font-weight: bold">=</span><span style="color: red">0</span><span style="font-weight: bold">,</span>l;<br/>    int n<span style="font-weight: bold">=</span><span style="color: red">10000</span>;<br/>    int a<span style="font-weight: bold">[</span><span style="color: red">10000</span><span style="font-weight: bold">]</span>;<br/>    <span style="color:#185369; font-weight: bold">for</span><span style="font-weight: bold">(</span>i<span style="font-weight: bold">=</span><span style="color: red">0</span>;i<span style="font-weight: bold">&lt;</span>n;i<span style="font-weight: bold">++)<br/></span>     prime<span style="font-weight: bold">[</span>i<span style="font-weight: bold">]=</span><span style="color: red">1</span>;<br/>    <span style="color:#185369; font-weight: bold">for</span><span style="font-weight: bold">(</span>i<span style="font-weight: bold">=</span><span style="color: red">2</span>;i<span style="font-weight: bold">&lt;</span>n;i<span style="font-weight: bold">++){<br/></span>     <span style="color:#185369; font-weight: bold">if</span><span style="font-weight: bold">(</span>prime<span style="font-weight: bold">[</span>i<span style="font-weight: bold">]==</span><span style="color: red">1</span><span style="font-weight: bold">){<br/></span>         <span style="color:#185369; font-weight: bold">for</span><span style="font-weight: bold">(</span>j<span style="font-weight: bold">=</span>i<span style="font-weight: bold">*</span>i;j<span style="font-weight: bold">&lt;</span>n;j<span style="font-weight: bold">+=</span>i<span style="font-weight: bold">){<br/></span>             prime<span style="font-weight: bold">[</span>j<span style="font-weight: bold">]=</span><span style="color: red">0</span>;<br/>            <span style="font-weight: bold">}<br/></span>     <span style="font-weight: bold">}<br/></span> <span style="font-weight: bold">}<br/></span> int k<span style="font-weight: bold">=</span><span style="color: red">0</span>;<br/>    <span style="color:#185369; font-weight: bold">for</span><span style="font-weight: bold">(</span>i<span style="font-weight: bold">=</span><span style="color: red">1000</span>;i<span style="font-weight: bold">&lt;</span><span style="color: red">10000</span>;i<span style="font-weight: bold">++){<br/></span>     <span style="color:#185369; font-weight: bold">if</span><span style="font-weight: bold">(</span>prime<span style="font-weight: bold">[</span>i<span style="font-weight: bold">]==</span><span style="color: red">1</span><span style="font-weight: bold">)<br/></span>         a<span style="font-weight: bold">[</span>k<span style="font-weight: bold">++]=</span>i;<br/>    <span style="font-weight: bold">}<br/></span> <span style="color:#185369; font-weight: bold">for</span><span style="font-weight: bold">(</span>i<span style="font-weight: bold">=</span><span style="color: red">0</span>;i<span style="font-weight: bold">&lt;</span>k;i<span style="font-weight: bold">++)</span>graph<span style="font-weight: bold">[</span>a<span style="font-weight: bold">[</span>i<span style="font-weight: bold">]]=</span>NULL;<br/>    <span style="color:#185369; font-weight: bold">for</span><span style="font-weight: bold">(</span>i<span style="font-weight: bold">=</span><span style="color: red">0</span>;i<span style="font-weight: bold">&lt;</span>k;i<span style="font-weight: bold">++){<br/></span>     <span style="color:#185369; font-weight: bold">for</span><span style="font-weight: bold">(</span>l<span style="font-weight: bold">=</span>i<span style="font-weight: bold">+</span><span style="color: red">1</span>;l<span style="font-weight: bold">&lt;</span>k;l<span style="font-weight: bold">++){<br/></span>         <span style="color:#185369; font-weight: bold">if</span><span style="font-weight: bold">(</span>check<span style="font-weight: bold">(</span>a<span style="font-weight: bold">[</span>i<span style="font-weight: bold">],</span>a<span style="font-weight: bold">[</span>l<span style="font-weight: bold">])){<br/></span>             graph<span style="font-weight: bold">[</span>a<span style="font-weight: bold">[</span>i<span style="font-weight: bold">]]=</span>insert<span style="font-weight: bold">(</span>graph<span style="font-weight: bold">[</span>a<span style="font-weight: bold">[</span>i<span style="font-weight: bold">]],</span>a<span style="font-weight: bold">[</span>l<span style="font-weight: bold">])</span>;<br/>                graph<span style="font-weight: bold">[</span>a<span style="font-weight: bold">[</span>l<span style="font-weight: bold">]]=</span>insert<span style="font-weight: bold">(</span>graph<span style="font-weight: bold">[</span>a<span style="font-weight: bold">[</span>l<span style="font-weight: bold">]],</span>a<span style="font-weight: bold">[</span>i<span style="font-weight: bold">])</span>;<br/>            <span style="font-weight: bold">}<br/></span>     <span style="font-weight: bold">}<br/></span> <span style="font-weight: bold">}<br/></span> int t;<br/>    si<span style="font-weight: bold">(</span>t<span style="font-weight: bold">)</span>;<br/>    <span style="color:#185369; font-weight: bold">while</span><span style="font-weight: bold">(</span>t<span style="font-weight: bold">--){<br/></span>     int s<span style="font-weight: bold">,</span>d;<br/>        si<span style="font-weight: bold">(</span>s<span style="font-weight: bold">)</span>;si<span style="font-weight: bold">(</span>d<span style="font-weight: bold">)</span>;<br/>        int ans<span style="font-weight: bold">=</span>bfs<span style="font-weight: bold">(</span>s<span style="font-weight: bold">,</span>d<span style="font-weight: bold">)</span>;<br/>        sout<span style="font-weight: bold">(</span>ans<span style="font-weight: bold">)</span>;<br/>    <span style="font-weight: bold">}<br/></span> <span style="color:#185369; font-weight: bold">return </span><span style="color: red">0</span>;<br/><span style="font-weight: bold">}<br/></span></pre></td></tr></table>